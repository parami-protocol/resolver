<!doctype html>
<html>
  <head>
    <title>chain server</title>
    <style>
      * { margin: 0; padding: 0; box-sizing: border-box; }
      body { font: 13px Helvetica, Arial; }
      .container {
        width: 1200px;
        margin: 20px auto;
      }
      .container button {
        margin: 10px;
      }
      button {
        border: none;
        background: #19be6b;
        color: #fff;
        outline: none;
        height: 45px;
        line-height: 45px;
        padding: 0 25px;
        font-size: 16px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <button class="create-genesis">创世账号</button>
      <button class="create-old">老账号</button>
      <button class="create-new">新账号</button>
      <button class="create-sns">社交账号</button>
      <button class="lock">抵押</button>
      <button class="unlock">赎回</button>
      <button class="set-name">设置团队名称</button>
    </div>
    <script src="https://cdn.bootcss.com/socket.io/2.2.0/socket.io.slim.js"></script>
    <script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.slim.min.js"></script>
    <script>
      $(function() {
        const socket = io();
        $('.create-genesis').click(function() {
          console.log('create genesis')
          const data = JSON.stringify({
            superior: '',
            address: '5CrRpNbQBTiBmTjpUgJ6mH9YRmopVweLsjffVz7muskYEo2r',
            pubkey: '0x22df4b685df33f070ae6e5ee27f745de078adff099d3a803ec67afe1168acd4f',
            type: '1',
            socialAccount: 'newfeiyang',
            isInit: true
          })
  
          socket.emit('create_by_old', data)
        })

        $('.create-old').click(function() {
          console.log('create old')
          const data = JSON.stringify({
            superior: '',
            address: '5CMDp8RSys5uBwct5XKY1rBtJtisTPuqZkxcbnho3jxWQJ51', // Airdrop
            pubkey: '0x0c98c49f1861d5f6ed9ea27230796a76878abbfbfb9716c64b2c7479a2197435',
            type: '1',
            socialAccount: 'wxid_7h9gf2umzeja22', // pratest1111  般若超级节点
            socialSuperior: 'newfeiyang',
            isInit: false
          })
  
          socket.emit('create_by_old', data)
        })

        $('.create-new').click(function() {
          console.log('create new account')
          const data = JSON.stringify({
            superior: 'did:pra:5GrwvaEF5zXb26Fz9rcQpDWS57CtERHpNehXCPcNoHGKutQY'
          })
  
          socket.emit('create', data)
        })

        $('.create-sns').click(function() {
          console.log('create sns account')
          const data = JSON.stringify({
            type: '1',
            sid: 'testwsgq',
            socialSuperior: 'wxid_7h9gf2umzeja22',
          })
  
          socket.emit('create_by_sns', data)
        })

        $('.lock').click(function() {
          const amount = 50 * Math.pow(10, 15)
          const data = JSON.stringify({
            address: '5FkLsKx5NB82JeHGEQbmcWY8ifDQ3KQqmJgPtD5zZxGstTLb',
            method: 'lock',
            params: [amount, 10]
          })

          console.log(data, 'lock data')
          socket.emit('sign', data)
        })
        
        $('.unlock').click(function() {
          const amount = 50 * Math.pow(10, 15)

          const data = JSON.stringify({
            address: '5FkLsKx5NB82JeHGEQbmcWY8ifDQ3KQqmJgPtD5zZxGstTLb',
            method: 'unlock',
            params: [amount]
          })

          console.log(data, 'unlock data')
          socket.emit('sign', data)
        })

        $('.set-name').click(function() {
          const data = JSON.stringify({
            address: '5FkLsKx5NB82JeHGEQbmcWY8ifDQ3KQqmJgPtD5zZxGstTLb',
            method: 'setGroupName',
            params: ['prochain']
          })

          console.log(data, 'set group name')
          socket.emit('sign', data)
        })

        socket.on('connect', function() {
          console.log('connect successfully')

          socket.on('Created', msg => {
            console.log(msg, 'create succeed')
          })
  
          socket.on('tx_failed', msg => {
            console.log(msg, 'create failed')
          })
  
          const data = JSON.stringify({
            superior: 'did:pra:5GrwvaEF5zXb26Fz9rcQpDWS57CtERHpNehXCPcNoHGKutQY'
          })
  
          // 0x01fdac14e7d3a031a01b7ca7dd206909b04306be25f2786fd7d0b4acbe04b9b7  hex did
          // socket.emit('create', data);
  
        })
  
        socket.on('disconnect', function(){
          console.log('disconnect')
        })

      })
    </script>
  </body>
</html>
